<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title></title>
</head>
<body>

    <script type="text/javascript" src="embedapi.js"></script>
    <script type="text/javascript">
        var svgCanvas = null;
        
        var globalSvgStr="";      //mf
  
        
       var preloadSvg = '<svg width="640" height="480" xmlns="http://www.w3.org/2000/svg"> <g id="svg_1"> <title>Layer 1</title> <g id="svg_IBg"> <rect fill="none" stroke="black" x="0" y="0" id="svg_IB" width="140" height="60"/> <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="70" y="18" id="svg_line1" font-size="18" font-family="serif" text-anchor="middle" xml:space="preserve">Universe={a,b}</text> <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="70" y="36" id="svg_line1" font-size="18" font-family="serif" text-anchor="middle" xml:space="preserve">F={a}</text> <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="70" y="54" id="svg_line1" font-size="18" font-family="serif" text-anchor="middle" xml:space="preserve">G={b}</text> </g> <!--start--> <g id="svg_ag"> <circle r="11" id="svg_a" cy="204" cx="105" stroke="black" fill="none"/> <text xml:space="preserve" text-anchor="middle" font-family="serif" font-size="18" id="svg_at" y="211" x="105" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">a</text> </g> <g id="svg_bg"> <circle r="11" id="svg_b" cy="182" cx="274" stroke="black" fill="none"/> <text xml:space="preserve" text-anchor="middle" font-family="serif" font-size="18" id="svg_bt" y="189" x="274" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">b</text> </g>  </g> </svg>';

       function startSvg(){
        	init_embed();
        	loadSvg();       	
        }
        
         function init_embed() {
            var frame = document.getElementById('svgedit');
			svgCanvas = new embedded_svg_edit(frame);
			svgCanvas.setMode('select');  //nov 2013
			           
        }
        
        function updateSvgStrSoftOpt(){
        	globalSvgStr="";
        	svgCanvas.getSvgString()(handleUpdate);    	
        }
        
        function handleUpdate(data, error) {
			if (error)
			{
				alert('error ' + error);
			}
            else
            	
			{
 //           	alert('updsyr] ' + data);
				globalSvgStr= data;
			}			
        }
        
        function getSvgStrSoftOpt(){   	
        	return globalSvgStr;
        }
        
        
        function handleSvgData(data, error) {
			if (error)
			{
				alert('error ' + error);
			}
            else
			{
				alert('Congratulations. Your SVG string is back in the host page, do with it what you will\n\n' + data);
			}			
        }
        
        function loadSvg() {
            svgCanvas.setSvgString(preloadSvg);
            globalSvgStr=preloadSvg;
        }
		
		function saveSvg() {			
			svgCanvas.getSvgString()(handleSvgData);
		}
    </script>


    <button onclick="loadSvg();">Load example</button>
    <button onclick="saveSvg();">Save data</button>
      <button onclick="updateSvgStrSoftOpt();">Update data</button>
     <button onclick="alert('first: ' + getSvgStrSoftOpt());">Get svg data</button>
    <br/>

    <iframe src="svgEditorMFTest.html" width="900px" height="600px" id="svgedit" onload="startSvg()"></iframe>    
</body>
</html>
